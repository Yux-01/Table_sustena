<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Semiconductor Suppliers Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 30px;
      color: #333;
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #004085;
    }
    /* Botones para rankear */
    .sort-controls {
      max-width: 900px;
      margin: 0 auto 20px;
      text-align: center;
    }
    .sort-btn {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 10px 18px;
      margin: 0 8px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s;
      user-select: none;
    }
    .sort-btn:hover, .sort-btn.active {
      background-color: #0056b3;
    }

    table {
      width: 100%;
      max-width: 900px;
      margin: 20px auto 40px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 14px 20px;
      border-bottom: 1px solid #ddd;
      text-align: center;
      user-select: none;
    }
    th {
      background: #007bff;
      color: white;
      font-weight: 600;
    }
    td.supplier {
      color: #007bff;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s;
    }
    td.supplier:hover {
      color: #0056b3;
      text-decoration: underline;
    }
    td .check {
      color: #28a745;
      font-weight: bold;
      font-size: 1.2em;
    }
    td .cross {
      color: #dc3545;
      font-weight: bold;
      font-size: 1.2em;
    }
    .details-container {
      max-width: 900px;
      margin: 0 auto 60px;
      background: white;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
      padding: 25px 30px;
      display: none;
      animation: fadeIn 0.4s ease forwards;
    }
    .details-container.active {
      display: block;
    }
    .charts {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 25px;
    }
    .chart-box {
      flex: 1 1 280px;
      max-width: 280px;
      background: #f8f9fa;
      border-radius: 10px;
      padding: 15px;
      box-shadow: inset 0 0 8px rgba(0,123,255,0.1);
      transition: box-shadow 0.3s ease;
    }
    .chart-box:hover {
      box-shadow: inset 0 0 15px rgba(0,123,255,0.4);
    }
    .chart-box h3 {
      text-align: center;
      margin-bottom: 15px;
      color: #004085;
      font-weight: 700;
    }
    .news {
      max-width: 800px;
      margin: 0 auto;
      color: #333;
    }
    .news h3 {
      color: #004085;
      margin-bottom: 15px;
    }
    .news ul {
      list-style-type: disc;
      padding-left: 20px;
      line-height: 1.6;
      max-height: 140px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 15px;
      background: #fefefe;
    }
    .news li {
      margin-bottom: 10px;
    }
    .news li.good {
      color: #155724;
      background: #d4edda;
      padding: 6px 10px;
      border-radius: 5px;
    }
    .news li.bad {
      color: #721c24;
      background: #f8d7da;
      padding: 6px 10px;
      border-radius: 5px;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
  </style>
</head>
<body>

  <h1>Semiconductor Suppliers Dashboard</h1>

  <div class="sort-controls">
    <button class="sort-btn active" data-key="cost">Sort by Cost (Low to High)</button>
    <button class="sort-btn" data-key="sustainability">Sort by Sustainability</button>
    <button class="sort-btn" data-key="speed">Sort by Speed (Fast to Slow)</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Supplier</th>
        <th>Cost (USD)</th>
        <th>Sustainability</th>
        <th>Speed (Days)</th>
      </tr>
    </thead>
    <tbody id="supplier-table-body">
      <!-- Filas se crean dinámicamente -->
    </tbody>
  </table>

  <div id="supplier-details" class="details-container" aria-live="polite" aria-atomic="true">
    <h2 id="details-title">Supplier Details</h2>
    <div class="charts">
      <div class="chart-box">
        <h3>Company Profile (Cost / Sustainability / Speed)</h3>
        <canvas id="profileChart"></canvas>
      </div>
      <div class="chart-box">
        <h3>Performance Scores</h3>
        <canvas id="performanceChart"></canvas>
      </div>
      <div class="chart-box">
        <h3>Speed Trend (Days to Deliver)</h3>
        <canvas id="trendChart"></canvas>
      </div>
    </div>
    <div class="news">
      <h3>Recent News</h3>
      <ul id="news-list"></ul>
    </div>
  </div>

<script>
  // Datos con valores coherentes para cada proveedor + good/bad news flags
  const supplierData = {
    A: {
      profile: {Cost: 2500, Sustainability: 70, Speed: 7},
      performance: {Cost: 65, Sustainability: 85, Speed: 90},
      trend: [8, 7, 7, 6, 7, 7],
      news: [
        {text: "Advanced Materials certified with ISO 14001 and ESG standards.", good: true},
        {text: "Advanced Materials shortens delivery time by 1 day.", good: true},
        {text: "Advanced Materials launches new green manufacturing line.", good: true}
      ]
    },
    B: {
      profile: {Cost: 1800, Sustainability: 60, Speed: 10},
      performance: {Cost: 80, Sustainability: 70, Speed: 75},
      trend: [11, 10, 10, 9, 10, 10],
      news: [
        {text: "SilitroMic maintains ISO 9001 certification.", good: true},
        {text: "SilitroMic expands production capacity.", good: true},
        {text: "SilitroMic invests in faster logistics.", good: true}
      ]
    },
    C: {
      profile: {Cost: 2200, Sustainability: 20, Speed: 5},
      performance: {Cost: 70, Sustainability: 25, Speed: 95},
      trend: [6, 5, 5, 4, 5, 5],
      news: [
        {text: "Micro-IP Inc focused on speed but lacks sustainability certifications.", good: false},
        {text: "Micro-IP Inc improves delivery times significantly.", good: true},
        {text: "Micro-IP Inc working on environmental compliance.", good: false}
      ]
    },
    D: {
      profile: {Cost: 2000, Sustainability: 50, Speed: 12},
      performance: {Cost: 75, Sustainability: 65, Speed: 60},
      trend: [13, 12, 12, 12, 11, 12],
      news: [
        {text: "Numio Corporation adopts ESG frameworks.", good: true},
        {text: "Numio Corporation faces slight delivery delays.", good: false},
        {text: "Numio Corporation optimizing production costs.", good: true}
      ]
    },
    E: {
      profile: {Cost: 2700, Sustainability: 80, Speed: 8},
      performance: {Cost: 60, Sustainability: 90, Speed: 85},
      trend: [9, 8, 8, 7, 8, 8],
      news: [
        {text: "WorldWates certified with ISO 14001 and ISO 50001.", good: true},
        {text: "WorldWates improves energy efficiency across plants.", good: true},
        {text: "WorldWates shortens average delivery by 1 day.", good: true}
      ]
    }
  };

  const supplierNames = {
    A: "Advanced Materials",
    B: "SilitroMic",
    C: "Micro-IP Inc",
    D: "Numio Corporation",
    E: "WorldWates"
  };

  // Estado actual
  let currentSupplier = null;
  let currentSortKey = 'cost';

  const detailsDiv = document.getElementById('supplier-details');
  const detailsTitle = document.getElementById('details-title');
  const newsList = document.getElementById('news-list');
  const tableBody = document.getElementById('supplier-table-body');
  const sortButtons = document.querySelectorAll('.sort-btn');

  // Crear tablas
  function renderTable() {
    // Ordenar según currentSortKey
    const sortedKeys = Object.keys(supplierData).sort((a,b) => {
      if(currentSortKey === 'cost') {
        return supplierData[a].profile.Cost - supplierData[b].profile.Cost;
      } else if(currentSortKey === 'sustainability') {
        // ordenar descendente para sustainability (más alto mejor)
        return supplierData[b].profile.Sustainability - supplierData[a].profile.Sustainability;
      } else if(currentSortKey === 'speed') {
        // menor días es mejor, ascendente
        return supplierData[a].profile.Speed - supplierData[b].profile.Speed;
      }
      return 0;
    });

    tableBody.innerHTML = '';
    sortedKeys.forEach(id => {
      const data = supplierData[id];
      const row = document.createElement('tr');

      const tdSupplier = document.createElement('td');
      tdSupplier.classList.add('supplier');
      tdSupplier.setAttribute('data-id', id);
      tdSupplier.textContent = supplierNames[id];
      row.appendChild(tdSupplier);

      const tdCost = document.createElement('td');
      tdCost.textContent = `$${data.profile.Cost}`;
      row.appendChild(tdCost);

      const tdSustain = document.createElement('td');
      const spanSust = document.createElement('span');
      if(data.profile.Sustainability > 40) {
        spanSust.textContent = 'ISO & ESG';
        spanSust.classList.add('check');
      } else {
        spanSust.textContent = 'None';
        spanSust.classList.add('cross');
      }
      tdSustain.appendChild(spanSust);
      row.appendChild(tdSustain);

      const tdSpeed = document.createElement('td');
      tdSpeed.textContent = data.profile.Speed;
      row.appendChild(tdSpeed);

      tableBody.appendChild(row);
    });

    // Re-agregar event listeners para click en suppliers
    document.querySelectorAll('td.supplier').forEach(cell => {
      cell.addEventListener('click', () => {
        const id = cell.getAttribute('data-id');
        toggleSupplierDetails(id);
      });
    });
  }

  // Crear gráficos
  let profileChartInstance = null;
  let performanceChartInstance = null;
  let trendChartInstance = null;

  function createProfileChart(data) {
    const ctx = document.getElementById('profileChart').getContext('2d');
    if(profileChartInstance) profileChartInstance.destroy();
    profileChartInstance = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: Object.keys(data),
        datasets: [{
          data: Object.values(data),
          backgroundColor: ['#007bff', '#28a745', '#ffc107'],
          hoverOffset: 30,
          borderWidth: 1,
          borderColor: '#ddd'
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom', labels: { font: { size: 14 }} },
          tooltip: { enabled: true }
        }
      }
    });
  }

  function createPerformanceChart(data) {
    const ctx = document.getElementById('performanceChart').getContext('2d');
    if(performanceChartInstance) performanceChartInstance.destroy();
    performanceChartInstance = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: Object.keys(data),
        datasets: [{
          label: 'Performance Score',
          data: Object.values(data),
          backgroundColor: ['#007bff', '#28a745', '#ffc107'],
          borderRadius: 6,
          borderSkipped: false
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true, max: 100 }
        },
        plugins: {
          legend: { display: false },
          tooltip: { enabled: true }
        }
      }
    });
  }

  function createTrendChart(data) {
    const ctx = document.getElementById('trendChart').getContext('2d');
    if(trendChartInstance) trendChartInstance.destroy();
    trendChartInstance = new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [{
          label: 'Delivery Days',
          data: data,
          fill: false,
          borderColor: '#17a2b8',
          tension: 0.3,
          pointBackgroundColor: '#17a2b8',
          pointRadius: 5,
          pointHoverRadius: 8,
          borderWidth: 3
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' },
          tooltip: { enabled: true }
        },
        scales: {
          y: { beginAtZero: true, max: 20 }
        }
      }
    });
  }

  // Render noticias con colores segun tipo (good/bad)
  function renderNews(newsArray) {
    newsList.innerHTML = '';
    newsArray.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item.text;
      li.classList.add(item.good ? 'good' : 'bad');
      newsList.appendChild(li);
    });
  }

  // Mostrar/ocultar detalles proveedor
  function toggleSupplierDetails(supplierId) {
    if(currentSupplier === supplierId) {
      detailsDiv.classList.remove('active');
      currentSupplier = null;
    } else {
      currentSupplier = supplierId;
      detailsTitle.textContent = `Supplier: ${supplierNames[supplierId]} Details`;
      const data = supplierData[supplierId];
      createProfileChart(data.profile);
      createPerformanceChart(data.performance);
      createTrendChart(data.trend);
      renderNews(data.news);
      detailsDiv.classList.add('active');
      detailsDiv.scrollIntoView({behavior: 'smooth'});
    }
  }

  // Botones ordenar
  sortButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      sortButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentSortKey = btn.getAttribute('data-key');
      renderTable();
      // Ocultar detalles al ordenar
      detailsDiv.classList.remove('active');
      currentSupplier = null;
    });
  });

  // Render inicial
  renderTable();

</script>

</body>
</html>
